<app-notification
  [show]="showError"
  type="error"
  [message]="errorMessage"
  (closed)="onErrorClosed()"
></app-notification>

<app-auth-layout
  title="Hello, it's me"
  footerText="Уже есть аккаунт?"
  footerLink="/auth/login"
  footerLinkText="Войти"
>
  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="space-y-4">
    <!-- Email -->
    <div>
      <label for="email" class="block text-sm font-medium text-white/70 mb-2">
        Email
      </label>
      <div class="relative">
        <div class="absolute left-3 top-1/2 -translate-y-1/2 text-white/40">
          <lucide-icon [img]="Mail" [size]="20"></lucide-icon>
        </div>
        <input
          id="email"
          type="email"
          formControlName="email"
          placeholder="your@email.com"
          [class]="getInputClasses('email')"
        />
        @if (getFieldError('email')) {
          <div class="absolute right-3 top-1/2 -translate-y-1/2 text-red-400">
            <lucide-icon [img]="AlertCircle" [size]="20"></lucide-icon>
          </div>
        }
      </div>
      @if (getFieldError('email')) {
        <p class="mt-2 text-sm text-red-400 flex items-center gap-1.5">
          <span class="text-xs">⚠</span>
          {{ getFieldError('email') }}
        </p>
      }
    </div>

    <!-- Username -->
    <div>
      <label for="username" class="block text-sm font-medium text-white/70 mb-2">
        Username <span class="text-xs text-white/30">(уникальный)</span>
      </label>
      <div class="relative">
        <div class="absolute left-3 top-1/2 -translate-y-1/2 text-white/40">
          <lucide-icon [img]="User" [size]="20"></lucide-icon>
        </div>
        <input
          id="username"
          type="text"
          formControlName="username"
          placeholder="username"
          [class]="getInputClasses('username')"
        />
        @if (getFieldError('username')) {
          <div class="absolute right-3 top-1/2 -translate-y-1/2 text-red-400">
            <lucide-icon [img]="AlertCircle" [size]="20"></lucide-icon>
          </div>
        }
      </div>
      @if (getFieldError('username')) {
        <p class="mt-2 text-sm text-red-400 flex items-center gap-1.5">
          <span class="text-xs">⚠</span>
          {{ getFieldError('username') }}
        </p>
      }
    </div>

    <!-- Password -->
    <div>
      <label for="password" class="block text-sm font-medium text-white/70 mb-2">
        Пароль
      </label>
      <div class="relative">
        <div class="absolute left-3 top-1/2 -translate-y-1/2 text-white/40">
          <lucide-icon [img]="Lock" [size]="20"></lucide-icon>
        </div>
        <input
          id="password"
          type="password"
          formControlName="password"
          placeholder="••••••••"
          [class]="getInputClasses('password')"
        />
        @if (getFieldError('password')) {
          <div class="absolute right-3 top-1/2 -translate-y-1/2 text-red-400">
            <lucide-icon [img]="AlertCircle" [size]="20"></lucide-icon>
          </div>
        }
      </div>
      @if (getFieldError('password')) {
        <p class="mt-2 text-sm text-red-400 flex items-center gap-1.5">
          <span class="text-xs">⚠</span>
          {{ getFieldError('password') }}
        </p>
      }
    </div>

    <!-- Confirm Password -->
    <div>
      <label for="confirmPassword" class="block text-sm font-medium text-white/70 mb-2">
        Подтвердите пароль
      </label>
      <div class="relative">
        <div class="absolute left-3 top-1/2 -translate-y-1/2 text-white/40">
          <lucide-icon [img]="Lock" [size]="20"></lucide-icon>
        </div>
        <input
          id="confirmPassword"
          type="password"
          formControlName="confirmPassword"
          placeholder="••••••••"
          [class]="getInputClasses('confirmPassword')"
        />
        @if (getFieldError('confirmPassword')) {
          <div class="absolute right-3 top-1/2 -translate-y-1/2 text-red-400">
            <lucide-icon [img]="AlertCircle" [size]="20"></lucide-icon>
          </div>
        }
      </div>
      @if (getFieldError('confirmPassword')) {
        <p class="mt-2 text-sm text-red-400 flex items-center gap-1.5">
          <span class="text-xs">⚠</span>
          {{ getFieldError('confirmPassword') }}
        </p>
      }
    </div>

    <!-- Submit Button -->
    <div class="pt-2">
      <app-button
        type="submit"
        variant="primary"
        size="lg"
        [fullWidth]="true"
        [loading]="isLoading"
        [disabled]="isLoading"
      >
        @if (isLoading) {
          Регистрация...
        } @else {
          Зарегистрироваться
        }
      </app-button>
    </div>
  </form>
</app-auth-layout>
